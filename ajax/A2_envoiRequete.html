<script src="../js/utils.js">
  // Fonction hide, show, html, val
</script>

<script type="text/javascript">

function envoiRequete(type, url, donnees, callback)
{
  var request = new XMLHttpRequest(); 
  
  function traiteReponse() {
	  if (request.readyState == 4) {
	      if (request.status == 200) {
			    var reponse = request.responseText;
			    // Appelle la fonction de callback
			    callback(reponse);
	      }
	  }
  } 

	if (type=='GET') 
	{
		request.open("GET", url+"?"+donnees, true);
		donnees=null;
	}
	else 
	{
		request.open("POST", url, true);
		request.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
	}

	request.onreadystatechange = traiteReponse;
	request.send(donnees);
}

// ^^^ Framework
///////////////////////////
// vvv MÃ©tier

function envoyer(refBtn)
{
	var type, donnees;
	
	if (val(refBtn) === 'envoi GET') {
	  type = 'GET';
  } else {
    type = 'POST';
  }
  
  donnees = 'cle=' + val("cle");
  
  // Appelle la fonction envoiRequete
  envoiRequete(
    type,
    'A2_data.php',
    donnees,
    function(r) { html("reponse", r); }
  );
}

</script>

<input type="text" id="cle"/>
<input type="button" value="envoi GET" onclick="envoyer(this);"/>
<input type="button" value="envoi POST" onclick="envoyer(this);"/>

<div id="reponse">
</div>

<textarea cols="40" rows="10">
Pour vous convaincre que c'est bien asynchrone, vous pouvez editer ce champ: il ne sera pas remis &agrave; jour !
</textarea>


















